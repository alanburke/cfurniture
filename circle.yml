machine:
  pre:
    - npm install -g casperjs@1.1.0-beta3
    - sudo pip install csvkit --allow-external csvkit --allow-unverified csvkit
    - sudo apt-get update
    - sudo apt-get install libfftw3-double3 libmagickcore5 imagemagick

general:
  branches:
    only:
    - master

dependencies:
  post:
    - npm run generate
    - npm run build

test:
  override:
    - casperjs test ./tests/phantom_tests.js

deployment:
  production:
    branch: master
    commands:
      - bundle exec s3_website push
